# -*- coding: utf-8 -*-
import scrapy
import re, json, requests
from scrapySchool_England_Ben.clearSpace import clear_space, clear_space_str, clear_lianxu_space
from scrapySchool_England_Ben.getItem import get_item
from scrapySchool_England_Ben.items import ScrapyschoolEnglandBenItem
from w3lib.html import remove_tags
from scrapySchool_England_Ben.remove_tags import remove_class
from scrapySchool_England_Ben.getIELTS import get_ielts
from lxml import etree
from scrapySchool_England_Ben.getStartDate import getStartDate
from scrapySchool_England_Ben.remove_tags import remove_class
from scrapySchool_England_Ben.getDuration import getIntDuration

class TheUniversityOfSheffield_USpider(scrapy.Spider):
    name = "TheUniversityOfSheffield_U"
    start_urls = ["https://www.sheffield.ac.uk/prospectus/courses-az.do?prospectusYear=2019"]

    def parse(self, response):
        links = ["https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C7412019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H1302019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6112019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=NT222019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=QV152019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H3602019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H3R22019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H4072019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=G4012019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=LK742019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=VW132019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=QR502019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=M1002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H2002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H3022019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H3012019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=G4042019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6212019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=CC4R2019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=G1022019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H3062019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H4042019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=Q3Q12019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=8T632019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=TN122019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H8042019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H2012019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H2252019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=HK212019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=8M742019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6102019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=LL232019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6132019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6532019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=NL212019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=QC182019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C1802019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C5212019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=0G312019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=L7222019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=L7002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=HK2D2019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=G4002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=G1R12019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C5092019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=F4102019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H3R12019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=B6212019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=J5052019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6162019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=T4152019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H2022019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=G6512019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=A2002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H3002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=QW342019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=N4202019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6562019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=KC392019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6222019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=T9002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=FV412019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=B9912019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H1042019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=FF3M2019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=G5002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=X3002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=J5012019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6492019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=T1102019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=NG212019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=F3212019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=G1122019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=CC452019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=B9092019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C5002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=T2102019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=LL122019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=G1102019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=LV252019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6142019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=M1M42019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=F8002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=L2012019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C7492019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H4052019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=GG122019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=Q3042019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6232019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=F4002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=LG112019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=VV562019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C4002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C7912019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H1002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=V1002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=F3712019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=FV352019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C5232019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6292019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=N2002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=F3V52019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=L4352019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=2G362019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=F9002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=CC472019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C4092019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=VG512019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=Q3062019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=VW532019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=T4T22019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H8012019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=RV602019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=K1002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=QR602019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H3H62019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H4002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=G6002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=2H262019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6602019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6522019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6452019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H67H2019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C1092019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=CC752019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=G1R22019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C7902019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=G1062019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=NL412019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6512019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C1012019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=L4312019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H1NF2019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6T92019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C4402019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=QV842019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6542019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=LL342019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=QL332019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=GN132019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=B9112019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=RL602019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=L2102019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=F3052019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6752019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=RV502019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=RL502019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=2G912019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6022019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6482019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=B5202019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=F1062019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H8102019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=HN622019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=F3092019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=V5002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6732019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H8602019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6592019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H9902019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=F3F52019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=L3902019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=QV352019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=CC742019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=GG742019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=M9002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=GG752019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=F1102019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=2S152019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=RN502019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=JH512019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H3H72019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=G1002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6342019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=G6542019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=GG142019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=TV112019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=M9302019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=VL132019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6152019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=KK132019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=T1T22019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=GG112019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=QV312019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H8J72019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C2092019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=M1M32019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=CC792019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6202019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H3R42019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=LV152019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=WTH42019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=G1R42019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H67I2019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H2T92019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=F8042019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=F3012019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H8402019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C1892019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=GG132019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C3002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=NG412019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=K3K42019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=G6042019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6472019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C10C2019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H4602019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=L1012019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=L3052019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=F3042019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C4492019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C1002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=J5002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H3612019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=M1M22019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=VV152019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=L3912019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=F1052019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H4062019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=B9012019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H1602019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6282019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H8002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C7092019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6902019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=QT122019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H4022019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=P5002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=RW502019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H3T72019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6552019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=FF352019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H8112019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=A1002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=K4002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H3052019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=V4002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=W3022019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=J2002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=F3442019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=TV212019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=CC4C2019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=CC7C2019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=8L552019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=L3002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=QW332019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=VL122019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=B9002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=G7042019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=JH562019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H3042019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C4332019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=2A472019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=M1M52019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H6332019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=L1N32019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=VR502019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=F9022019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H4902019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=B7402019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=F1002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=L1002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C7002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=N1202019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=G4032019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=J5912019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=JH5P2019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=G4022019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C4312019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C3092019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=B9022019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=H2102019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=F3502019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C7202019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=8L162019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=F3002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=G7002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=G1032019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=F2H82019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=G6502019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C8002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=T3002019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=M1202019",
"https://www.sheffield.ac.uk/prospectus/courseDetails.do?id=C2002019", ]
        # print(len(links))
        links = list(set(links))
        # print(len(links))
        for link in links:
            # # print(link, "-----")
            # if "http" not in link:
            #     url = "https://www.sheffield.ac.uk/prospectus/" + link
            # else:
            url = link
            yield scrapy.Request(url, callback=self.parse_data, meta={'url': url})

    def parse_data(self, response):
        item = get_item(ScrapyschoolEnglandBenItem)
        item['university'] = "The University of Sheffield"
        item['url'] = response.meta['url']
        print("===============================")
        print(response.url)
        print(response.meta['url'])
        try:
            # 专业、学位类型
            programmeDegree_type = response.xpath(
                "//div[@class='titles']/h2//text()").extract()
            if len(programmeDegree_type) == 0:
                programmeDegree_type = response.xpath(
                    "//main[@class='main content']/h2[1]//text()").extract()
            programmeDegree_type = ''.join(programmeDegree_type).strip()
            print("programmeDegree_type: ", programmeDegree_type)
            degree_typeList = re.findall(r"[A-Za-z/\(\)]*$", programmeDegree_type)
            # print("degree_typeList: ", degree_typeList)
            programme = programmeDegree_type
            if len(degree_typeList) != 0:
                degree_type = ''.join(list(degree_typeList[0]))
                item['degree_name'] = degree_type
                programme = programmeDegree_type.replace(item['degree_name'], '')
            print("item['degree_name']: ", item['degree_name'])
            item['programme_en'] = ''.join(programme)
            print("item['programme_en']: ", item['programme_en'])


            ucascode = response.xpath(
                "//span[@id='adCode']//text()").extract()
            clear_space(ucascode)
            if len(ucascode) > 0:
                item['ucascode'] = ''.join(ucascode[0]).strip()
            print("item['ucascode'] = ", item['ucascode'])


            alevel = response.xpath(
                "//html//div[@id='courseSummary']//tr/td[contains(text(), 'A Levels')]/following-sibling::td//text()").extract()
            clear_space(alevel)
            if len(alevel) > 0:
                item['alevel'] = ''.join(alevel[0]).strip()
            # print("item['alevel'] = ", item['alevel'])

            ib = response.xpath(
                "//html//div[@id='courseSummary']//tr/td[contains(text(), 'International Baccalaureate')]/following-sibling::td//text()").extract()
            item['ib'] = ''.join(ib).strip()
            # print("item['ib'] = ", item['ib'])

            tuition_feeDict = {"C180": "21450",
                               "C200": "21450",
                               "C300": "21450",
                               "C100": "21450",
                               "C109": "21450",
                               "C189": "21450",
                               "C209": "21450",
                               "C309": "21450",
                               "C1C9": "21450",
                               "C1CX": "21450",
                               "C1R9": "21450",
                               "C101": "21450",
                               "F400": "18900",
                               "FV41": "18900",
                               "VV46": "18900",
                               "VR47": "18900",
                               "VR41": "18900",
                               "VR42": "18900",
                               "F410": "18900",
                               "VR44": "18900",
                               "QV84": "18900",
                               "F401": "18900",
                               "KK13": "21450",
                               "K100": "21450",
                               "ARCU123": "21450",
                               "ARCU124": "21450",
                               "ARCU13": "21450",
                               "ARCU129": "21450",
                               "Y001": "16800",
                               "H130": "21450",
                               "G500": "21450",
                               "H690": "21450",
                               "H660": "21450",
                               "H310": "21450",
                               "H360": "21450",
                               "H361": "21450",
                               "H1NF": "21450",
                               "H1NF": "21450",
                               "HN62": "21450",
                               "OG31": "21450",
                               "8L16": "21450",
                               "57": "21450",
                               "2G36": "21450",
                               "8M74": "21450",
                               "2A47": "21450",
                               "H653": "21450",
                               "H659": "21450",
                               "B900": "21450",
                               "B909": "21450",
                               "H810": "21450",
                               "H800": "21450",
                               "H840": "21450",
                               "H8T9": "21450",
                               "H8F1": "21450",
                               "H8J7": "21450",
                               "H801": "21450",
                               "F100": "21450",
                               "F105": "21450",
                               "F107": "21450",
                               "F106": "21450",
                               "F335": "21450",
                               "F109": "21450",
                               "F108": "21450",
                               "C720": "21450",
                               "H210": "21450",
                               "HK21": "21450",
                               "H2T9": "21450",
                               "H200": "21450",
                               "H202": "21450",
                               "HK2D": "21450",
                               "H2N2": "21450",
                               "2H26": "21450",
                               "8T63": "21450",
                               "8L55": "21450",
                               "2G91": "21450",
                               "H201": "21450",
                               "A200": "21450",
                               "G600": "21450",
                               "G650": "21450",
                               "G402": "21450",
                               "G400": "21450",
                               "GG41": "21450",
                               "GG74": "21450",
                               "G4G1": "21450",
                               "G700": "21450",
                               "G490": "21450",
                               "G495": "21450",
                               "G401": "21450",
                               "G651": "21450",
                               "GN52": "21450",
                               "GN53": "21450",
                               "X301": "16800",
                               "F401": "18900",
                               "Q305": "16800",
                               "Q310": "16800",
                               "F901": "18900",
                               "L701": "18900",
                               "V101": "16800",
                               "Q307": "16800",
                               "V501": "16800",
                               "L301": "16800",
                               "L401": "16800",
                               "K401": "16800",
                               "K441": "16800",
                               "L790": "16800",
                               "QC19": "21450",
                               "B990": "21450",
                               "C801": "21450",
                               "V642": "16800",
                               "L432": "16800",
                               "T210": "16800",
                               "T300": "18900",
                               "TN42": "18900",
                               "T110": "16800",
                               "T415": "16800",
                               "TN12": "18900",
                               "T1T2": "16800",
                               "T4T2": "16800",
                               "T1R2": "16800",
                               "T2R2": "16800",
                               "T1R4": "16800",
                               "T2R4": "16800",
                               "T1R7": "16800",
                               "T2R7": "16800",
                               "T1R1": "16800",
                               "TV11": "16800",
                               "TV21": "16800",
                               "L100": "16800",
                               "LV15": "16800",
                               "LL12": "16800",
                               "L101": "16800",
                               "LG11": "16800",
                               "L1N3": "16800",
                               "LIN3": "16800",
                               "X300": "16800",
                               "X301": "16800",
                               "H620": "21450",
                               "H621": "21450",
                               "H610": "21450",
                               "H613": "21450",
                               "H614": "21450",
                               "H651": "21450",
                               "H647": "21450",
                               "H645": "21450",
                               "H6T9": "21450",
                               "H623": "21450",
                               "H615": "21450",
                               "H616": "21450",
                               "H652": "21450",
                               "H649": "21450",
                               "H622": "21450",
                               "H611": "21450",
                               "H648": "21450",
                               "H629": "21450",
                               "H628": "21450",
                               "H602": "21450",
                               "H603": "21450",
                               "H100": "21450",
                               "H104": "21450",
                               "H675": "21450",
                               "H673": "21450",
                               "H67I": "21450",
                               "H67H": "21450",
                               "Q3Q1": "16800",
                               "QL33": "16800",
                               "QR14": "16800",
                               "QR17": "16800",
                               "QR32": "16800",
                               "QR37": "16800",
                               "QV15": "16800",
                               "QT12": "16800",
                               "Q304": "16800",
                               "Q310": "16800",
                               "Q305": "16800",
                               "Q306": "16800",
                               "QR31": "16800",
                               "QV31": "16800",
                               "QW33": "16800",
                               "QV35": "16800",
                               "QR34": "16800",
                               "QW34": "16800",
                               "Q307": "16800",
                               "F309": "21450",
                               "G109": "21450",
                               "QR11": "16800",
                               "R120": "16800",
                               "RL11": "16800",
                               "RL12": "16800",
                               "RN12": "16800",
                               "RR12": "16800",
                               "RR14": "16800",
                               "RR17": "16800",
                               "RV11": "16800",
                               "RV15": "16800",
                               "RW13": "16800",
                               "R1R9": "16800",
                               "R1T2": "16800",
                               "R1R7": "16800",
                               "R1RR": "16800",
                               "R1RO": "16800",
                               "L700": "18900",
                               "F800": "18900",
                               "F902": "18900",
                               "F900": "18900",
                               "F901": "18900",
                               "QR12": "16800",
                               "R220": "16800",
                               "RL21": "16800",
                               "RL22": "16800",
                               "RN22": "16800",
                               "RR24": "16800",
                               "RR27": "16800",
                               "RV21": "16800",
                               "RV25": "16800",
                               "RW23": "18900",
                               "R2R9": "16800",
                               "R2T2": "16800",
                               "R2R7": "16800",
                               "R2RR": "16800",
                               "R2R3": "16800",
                               "R410": "16800",
                               "RL42": "16800",
                               "RN42": "16800",
                               "RL41": "16800",
                               "R4T2": "16800",
                               "R4R7": "16800",
                               "R4RR": "16800",
                               "V100": "16800",
                               "RV71": "16800",
                               "RV41": "16800",
                               "VV15": "16800",
                               "VL12": "16800",
                               "VL13": "16800",
                               "V1R9": "16800",
                               "V101": "16800",
                               "B620": "21450",
                               "QC18": "21450",
                               "QC19": "21450",
                               "P110": "18900",
                               "P500": "18900",
                               "K3K4": "18900",
                               "KC39": "18900",
                               "M100": "16800",
                               "ML94": "16800",
                               "M1R4": "16800",
                               "M1R2": "16800",
                               "M1R1": "16800",
                               "M930": "16800",
                               "M120": "16800",
                               "N200": "16800",
                               "N420": "16800",
                               "NG21": "16800",
                               "NG41": "16800",
                               "NL21": "16800",
                               "NL41": "16800",
                               "NP21": "16800",
                               "NP41": "16800",
                               "NT22": "16800",
                               "N120": "16800",
                               "JH51": "21450",
                               "J500": "21450",
                               "J5R9": "21450",
                               "FH21": "21450",
                               "J200": "21450",
                               "FHF1": "21450",
                               "H403": "21450",
                               "H401": "21450",
                               "JH5P": "21450",
                               "JH56": "21450",
                               "J501": "21450",
                               "G100": "18900",
                               "G103": "18900",
                               "GN13": "18900",
                               "G102": "18900",
                               "G1R4": "18900",
                               "G1R1": "18900",
                               "G1R2": "18900",
                               "G106": "18900",
                               "VG51": "18900",
                               "A100": "21450",
                               "T900": "16800",
                               "C400": "21450",
                               "C500": "21450",
                               "C440": "21450",
                               "C700": "21450",
                               "C741": "21450",
                               "CC45": "21450",
                               "CC74": "21450",
                               "CC75": "21450",
                               "C709": "21450",
                               "CC7C": "21450",
                               "CC79": "21450",
                               "C409": "21450",
                               "CC4C": "21450",
                               "C749": "21450",
                               "C509": "21450",
                               "C449": "21450",
                               "C790": "21450",
                               "C791": "21450",
                               "CC47": "21450",
                               "CC4R": "21450",
                               "C431": "21450",
                               "C433": "21450",
                               "C521": "21450",
                               "C523": "21450",
                               "W302": "18900",
                               "RW43": "18900",
                               "VW53": "18900",
                               "WT34": "18900",
                               "WT31": "18900",
                               "WTH4": "18900",
                               "B991": "21450",
                               "B740": "21450",
                               "B990": "21450",
                               "B520": "21450",
                               "QV36": "16800",
                               "RV26": "16800",
                               "QV16": "16800",
                               "VW63": "16800",
                               "VV56": "16800",
                               "VR61": "16800",
                               "BIBU08": "16800",
                               "V641": "16800",
                               "V500": "16800",
                               "RV45": "16800",
                               "V501": "16800",
                               "F300": "21450",
                               "F301": "21450",
                               "F344": "21450",
                               "F350": "21450",
                               "FF35": "21450",
                               "F371": "21450",
                               "F3F5": "21450",
                               "FV35": "21450",
                               "F321": "21450",
                               "F3G4": "21450",
                               "F3GK": "21450",
                               "F305": "21450",
                               "F304": "21450",
                               "F3F5": "21450",
                               "L210": "16800",
                               "LL23": "16800",
                               "LV25": "16800",
                               "L201": "16800",
                               "LL24": "16800",
                               "C800": "21450",
                               "C802": "21450",
                               "C801": "21450",
                               "R710": "16800",
                               "RL71": "16800",
                               "RL72": "16800",
                               "RN72": "16800",
                               "RR47": "16800",
                               "R7R7": "16800",
                               "R7RR": "16800",
                               "RV75": "16800",
                               "RW73": "18900",
                               "R7T2": "16800",
                               "L300": "16800",
                               "LL43": "16800",
                               "NL2K": "16800",
                               "NL24": "16800",
                               "L391": "16800",
                               "L301": "16800",
                               "L401": "16800",
                               "L722": "16800",
                               "TRPU105": "16800",
                               "LK74": "18900",
                               "K401": "16800",
                               "K441": "16800",
                               "L790": "16800", }
            tuition_fee = tuition_feeDict.get(item['ucascode'])
            print("tuition_fee: ", tuition_fee)
            if tuition_fee != None:
                item['tuition_fee'] = int(''.join(tuition_fee))
                item['tuition_fee_pre'] = "£"
            print("item['tuition_fee']: ", item['tuition_fee'])
            print("item['tuition_fee_pre']: ", item['tuition_fee_pre'])
            yield item
        except Exception as e:
            with open("scrapySchool_England_Ben/error/" + item['university'] + str(item['degree_type']) + ".txt", 'a',
                      encoding="utf-8") as f:
                f.write(str(e) + "\n" + response.url + "\n========================\n")
            print("异常：", str(e))
            print("报错url：", response.url)

